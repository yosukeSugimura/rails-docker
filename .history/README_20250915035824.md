# 🚀 Rails Docker Template

[![Ruby](https://img.shields.io/badge/ruby-3.2.5-red.svg)](https://ruby-lang.org)
[![Rails](https://img.shields.io/badge/rails-6.1.7-red.svg)](https://rubyonrails.org)
[![Docker](https://img.shields.io/badge/docker-compose-blue.svg)](https://docker.com)
[![PostgreSQL](https://img.shields.io/badge/postgresql-13-blue.svg)](https://postgresql.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

モダンなRailsアプリケーション開発のためのDocker環境テンプレートです。開発からプロダクションまで一貫した環境を提供し、チーム開発を効率化します。

## ✨ 特徴

- 🐳 **Docker完全対応**: 複雑な環境構築不要
- ⚡ **高速起動**: 最適化されたDockerfile
- 🔧 **開発・本番対応**: 環境別設定ファイル
- 🧪 **テスト環境**: RSpec + FactoryBot構成
- 📊 **コードカバレッジ**: SimpleCov統合
- 🔐 **セキュリティ**: セキュアなコンテナ設計
- 📱 **レスポンシブ**: モバイル対応UI

## 🛠️ 技術スタック

| カテゴリ | 技術 | バージョン |
|----------|------|------------|
| Backend | Ruby on Rails | 6.1.7 |
| Database | PostgreSQL | 13 |
| Background Jobs | Sidekiq | latest |
| Testing | RSpec | latest |
| Container | Docker & Docker Compose | latest |

## 📋 前提条件

以下がインストールされている必要があります：

- [Docker](https://www.docker.com/get-started/) (v20.10+)
- [Docker Compose](https://docs.docker.com/compose/install/) (v2.0+)
- [Git](https://git-scm.com/) (v2.28+)

## 🚀 クイックスタート

### 1. リポジトリのクローン

```bash
git clone https://github.com/yosukeSugimura/rails-docker.git
cd rails-docker
```

### 2. 環境変数の設定

```bash
cp .env.example .env
# .envファイルを編集して必要な設定を行う
```

### 3. アプリケーションの起動

```bash
# 開発環境の起動
make dev-up

# または手動で起動
docker-compose up --build -d
```

### 4. データベースの初期化

```bash
make db-setup

# または手動で実行
docker-compose exec web rails db:create
docker-compose exec web rails db:migrate
docker-compose exec web rails db:seed
```

### 5. アプリケーションへのアクセス

🌐 [http://localhost:3000](http://localhost:3000) でアプリケーションが利用できます。

## 🔧 開発コマンド

便利なMakefileコマンドを用意しています：

```bash
# 開発環境
make dev-up          # 開発環境起動
make dev-down        # 開発環境停止
make dev-logs        # ログ表示

# データベース
make db-setup        # DB初期化
make db-migrate      # マイグレーション実行
make db-rollback     # マイグレーション巻き戻し

# テスト
make test            # テスト実行
make test-coverage   # カバレッジ付きテスト

# メンテナンス
make clean           # 不要なイメージ・ボリューム削除
make shell           # コンテナ内シェル起動
```

## 🌍 環境別設定

### 開発環境

```bash
docker-compose -f docker-compose.yml -f docker-compose.override.yml up -d
```

### プロダクション環境

```bash
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

## 🧪 テスト実行

```bash
# 全テスト実行
docker-compose exec web bundle exec rspec

# カバレッジ付きテスト実行
docker-compose exec web bundle exec rspec --require spec_helper

# 特定のテストファイル実行
docker-compose exec web bundle exec rspec spec/models/user_spec.rb
```

## 📊 コードカバレッジ

SimpleCovを使用してコードカバレッジを測定できます：

```bash
make test-coverage
open coverage/index.html  # macOSの場合
```

## 🔐 セキュリティ

このテンプレートは以下のセキュリティ対策を実装しています：

- 非rootユーザーでのコンテナ実行
- 最小限のパッケージインストール
- セキュリティアップデート適用
- 機密情報の環境変数化

## 🚀 デプロイ

### Heroku

```bash
# Heroku CLI経由でのデプロイ
heroku create your-app-name
heroku container:push web
heroku container:release web
```

### AWS/GCP

Docker imageをビルドしてクラウドサービスにデプロイできます。

## 🤝 コントリビューション

1. このリポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📝 ライセンス

このプロジェクトは[MIT License](LICENSE)の下で公開されています。

## 👨‍💻 作者

**Yosuke Sugimura**

- GitHub: [@yosukeSugimura](https://github.com/yosukeSugimura)
- Twitter: [@your_twitter](https://twitter.com/your_twitter)

## 🙏 謝辞

このプロジェクトは以下のオープンソースプロジェクトに支えられています：

- [Ruby on Rails](https://rubyonrails.org/)
- [PostgreSQL](https://www.postgresql.org/)
- [Docker](https://www.docker.com/)

---

⭐ このプロジェクトが役に立った場合は、ぜひスターをお願いします！
